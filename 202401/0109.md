# TIL (Today I Learned)

# 1ì›” 9ì¼ í™”ìš”ì¼

# ğŸ˜ƒÂ What I Learned

## í”„ë¡œì íŠ¸ 2ì¼ì°¨

- ì£¼ê¸°ëŠ¥ ëª…ì„¸ì„œ ì‘ì„±
- ì¶”ê°€ê¸°ëŠ¥ ëª…ì„¸ì„œ ì‘ì„±

## ìŠ¤í”„ë§ íŠ¸ëœì­ì…˜

- **íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë°œì „ ê³¼ì •**
    1. **íŠ¸ëœì­ì…˜ (ê¸°ìˆ  ì¢…ì†ëœ ì½”ë“œ)**
    2. **íŠ¸ëœì­ì…˜ ì¶”ìƒí™”**
        - PlatformTransactionManager
            - JDBC, JPA, Hibernate ë“±ì˜ ê¸°ìˆ ì— ì¢…ì†ì ì¸ ì½”ë“œê°€ ì•„ë‹Œ ì¼ê´€ëœ íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ìœ„í•œ ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ ì œê³µ
    3. **AOPë¥¼ ì´ìš©í•œ ì„ ì–¸ì  íŠ¸ëœì­ì…˜**
        - @Transactional
            - íŠ¸ëœì­ì…˜ ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬ë¶„
        
- **íŠ¸ëœì­ì…˜ ì „íŒŒ**
    - ë¬¼ë¦¬ / ë…¼ë¦¬ íŠ¸ëœì­ì…˜
    - íŠ¹ì§•
        - **â€œì‹ ê·œâ€ íŠ¸ëœì­ì…˜ë§Œì´ ë¬¼ë¦¬ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹/ë¡¤ë°±í•  ìˆ˜ ìˆë‹¤**
            - ì°¸ì—¬ê°€ ì•„ë‹Œ ê¸°ì¡´ íŠ¸ëœì­ì…˜ì„ ì˜ë¯¸
    - REQUIRED : default, ê¸°ì¡´ íŠ¸ëœì­ì…˜ì— ì°¸ì—¬, ì—†ìœ¼ë©´ ì‹ ê·œ íŠ¸ëœì­ì…˜
    - REQUIRES_NEW : ê¸°ì¡´ íŠ¸ëœì­ì…˜ì— ë¬´ê´€í•˜ê²Œ ì‹ ê·œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë…ìì ìœ¼ë¡œ ì§„í–‰
    - NOT_SUPPORTED : í´ë˜ìŠ¤ ì „ì²´ì— íŠ¸ëœì­ì…˜ì„ ê±¸ì–´ë‘ì—ˆì„ ë•Œ íŠ¹ì • ë©”ì†Œë“œì— íŠ¸ëœì­ì…˜ì„ ê±¸ê³  ì‹¶ì§€ ì•Šì„ ë•Œì— í•˜ë©´ ì‚¬ìš© (ë‹¨ìˆœ ë°ì´í„° ì¡°íšŒ)
- **ê²©ë¦¬ìˆ˜ì¤€**
    - default : ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ì•¡ì„¸ìŠ¤ ê¸°ìˆ , DB ë“œë¼ì´ë²„ default ì„¤ì • ë”°ë¦„
- **ì œí•œì‹œê°„ (timeout)**
    - defaultëŠ” ë¬´ì œí•œìœ¼ë¡œ REQUIRED, REQUIRES_NEW ì˜ ê²½ìš° ì˜ë¯¸ìˆìŒ
- **ì½ê¸° ì „ìš© (readonly = true)**
    - ë°ì´í„° ì¡°ì‘ ì‹œë„ ë°©ì§€ ë° ê¸°ìˆ ì— ë”°ë¼ ì„±ëŠ¥ í–¥ìƒ ê°€ëŠ¥

[https://mangkyu.tistory.com/170](https://mangkyu.tistory.com/170)

- **Spring @Transactionalì˜ ë¡¤ë°± ì²˜ë¦¬**
    - ì–¸ì²´í¬ ì˜ˆì™¸(ëŸ°íƒ€ì„ ì˜ˆì™¸)ë¼ë©´ ìë™ì ìœ¼ë¡œ ë¡¤ë°±ì´ ë°œìƒ
    - ì²´í¬ ì˜ˆì™¸ë¼ë©´ ë¡¤ë°±ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì²´í¬ ì˜ˆì™¸ë¥¼ ë¡¤ë°±ì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” @Transactionalì˜ rollbackFor ì†ì„±ìœ¼ë¡œ í•´ë‹¹ ì²´í¬ ì˜ˆì™¸ë¥¼ ì ì–´ì£¼ì–´ì•¼
    - ì™œ?
        - í•´ë‹¹ ì˜ˆì™¸ë“¤ì´ ë³µêµ¬ ê°€ëŠ¥ì„±ì´ ì—†ëŠ” ì˜ˆì™¸ë“¤ì´ë¯€ë¡œ ë³„ë„ì˜ try-catchë‚˜ throwë¥¼ í†µí•´ ì²˜ë¦¬ë¥¼ ê°•ì œí•˜ì§€ ì•Šê¸° ë•Œë¬¸
        - ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ì€ ë‚´ë¶€ì ìœ¼ë¡œ ì–¸ì²´í¬ ì˜ˆì™¸(ëŸ°íƒ€ì„ ì˜ˆì™¸)ì´ê±°ë‚˜ ì—ëŸ¬(Error) ì¸ì§€ ê²€ì‚¬í•œ í›„ì— ë§ìœ¼ë©´ ë¡¤ë°± ì—¬ë¶€ë¥¼ ê²°ì •í•˜ëŠ” rollback-onlyë¥¼ Trueë¡œ ë³€ê²½í•˜ëŠ” ë¡œì§ì´ ìˆë‹¤.
        - (ì •í™•íˆëŠ” TransactionInfoì˜ transactionAttributeì˜ rollbackOnì— ì˜í•´ ê²€ì‚¬ëœë‹¤)
    - **ì´ê±´ ëª¨ë“  ì²´í¬ ì˜ˆì™¸, ì–¸ì²´í¬ ì˜ˆì™¸ì— ì ìš©ë˜ëŠ” ë‚´ìš©ì´ ì•„ë‹ˆë‹¤!! (ë°±ê¸°ì„ ë‹˜ ìœ íŠœë¸Œ)**

- **fallback policy**
    - íƒ€ê¹ƒ ë©”ì†Œë“œ, íƒ€ê¹ƒ í´ë˜ìŠ¤, ì„ ì–¸ ë©”ì†Œë“œ, ì„ ì–¸ íƒ€ì…(í´ë˜ìŠ¤ or ì¸í„°í˜ì´ìŠ¤) ìˆœìœ¼ë¡œ @Transactionalì´ ì ìš©ë˜ì—ˆëŠ”ì§€ ì°¨ë¡€ë¡œ í™•ì¸

- **Where should we use Transaction?**
    1. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
        - ì¼ë°˜ì ìœ¼ë¡œÂ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ë‹´ê³  ìˆëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì˜ ë©”ì†Œë“œì™€ ê²°í•©ì‹œí‚¤ëŠ” ê²ƒì´ ì¢‹ë‹¤.
        - **ë°ì´í„° ì €ì¥ ê³„ì¸µìœ¼ë¡œë¶€í„° ì½ì–´ì˜¨ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê³  ë³€ê²½í•˜ëŠ” ë“±ì˜ ì‘ì—…ì„ í•˜ëŠ” ê³³ì´ ì„œë¹„ìŠ¤ ê³„ì¸µì´ê¸° ë•Œë¬¸**
        - í´ë˜ìŠ¤ ë ˆë²¨ì— íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ë©´ ë©”ì†Œë“œê¹Œì§€ ì ìš©ë¨
        - ê°€ëŠ¥í•˜ë©´ ë‹¤ë¥¸ ëª¨ë“ˆì˜ DAOì— ì ‘ê·¼í•  ë•ŒëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì„ ê±°ì¹˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ë‹¤.
    2. **ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ì„ ê³µí†µí™”í•˜ì**
        - í´ë˜ìŠ¤ ë ˆë²¨ì—ëŠ” ê³µí†µì ìœ¼ë¡œ ì ìš©ë˜ëŠ” ì½ê¸°ì „ìš© íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì„ ì„ ì–¸
        - ì¶”ê°€ë‚˜ ì‚­ì œ ë˜ëŠ” ìˆ˜ì •ì´ ìˆëŠ” ì‘ì—…ì—ëŠ” ì“°ê¸°ê°€ ê°€ëŠ¥í•˜ë„ë¡ ë³„ë„ë¡œ @Transacional ì–´ë…¸í…Œì´ì…˜ì„ ë©”ì†Œë“œì— ì„ ì–¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ
            - ì„±ëŠ¥ ì´ì ì´ ìˆë‹¤!
            - fallback policy
    3. **í…ŒìŠ¤íŠ¸**
        - íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì„ í…ŒìŠ¤íŠ¸ì— ë¶™ì´ë©´Â í…ŒìŠ¤íŠ¸ì˜ DB ì»¤ë°‹ì„ ë¡¤ë°±í•´ì¤€ë‹¤
            - @Rollback(false) : ë©”ì†Œë“œ ë‹¨ìœ„
            - @TransactionConfiguration(defaultRollback=false) : í´ë˜ìŠ¤ ë‹¨ìœ„
        - **ì£¼ì˜í•  ë‚´ìš©ì€ auto_increment, sequence ë“±ìœ¼ë¡œ ì¦ê°€í•œ ê°’ì€ ë¡¤ë°± ì•ˆë¨**
        - **í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œëŠ” ë³„ë„ì˜ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì—°ê²°í•˜ì**
            - **@DataJpaTest** =  JPAê´€ë ¨ Beanê³¼ @Transactional ì–´ë…¸í…Œì´ì…˜
            - application-test.ymlì„ resources í´ë”ì— ë§Œë“ ë‹¤!
            - [https://0soo.tistory.com/40](https://0soo.tistory.com/40)

## ê°‘ìê¸° ê¶ê¸ˆí•´ì§„ ë‚´ìš©

- ëŒë‹¤ì‹ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ëŠ”ë‹¤ë©´ ê·¸ íƒ€ì…ì€ ë¬´ì—‡ì¸ê°€?
    - **í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤**
        - **ë”± í•˜ë‚˜ì˜ ì¶”ìƒ ë©”ì„œë“œë¥¼ ê°€ì§„ ì¸í„°í˜ì´ìŠ¤**
        - ì˜ˆì‹œëŠ” ì•„ë˜
        1. Runnable
            - ëŒ€í‘œì ì¸ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ Runnable â†’ run()
            - **ëŒë‹¤ì‹ì˜ ë‚´ìš©ì´ ì¶”ìƒ ë©”ì„œë“œì˜ ë‚´ìš©ì´ ëœë‹¤**
            - **ì•„ë˜ ë‘ ë‚´ìš©ì€ ë™ì¼í•˜ë‹¤!**
            
            ```java
            Runnable myRunnable = () -> {
                // run() ë©”ì„œë“œì˜ ë‚´ìš©
                System.out.println("Hello, Lambda!");
            };
            ```
            
            ```java
            Runnable myRunnable = new Runnable() {
                @Override
                public void run() {
                    // run() ë©”ì„œë“œì˜ ë‚´ìš©
                    System.out.println("Hello, Anonymous Inner Class!");
                }
            };
            ```
            
        2. Consumer<T>
            - consumerì„ìœ¼ë¡œ ê°’ì„ ì†Œë¹„
            - void accept(T) ë©”ì†Œë“œê°€ ìˆìœ¼ë©° ë¦¬í„´ê°’ì´ voidì´ë‹¤.
            
            ```java
            Consumer<Integer> c = (t) -> System.out.println(t+2);
            ```
            
        3. Supplier<T>
            - ë§¤ê°œë³€ìˆ˜ê°€ ì—†ê³ , ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤
            - T get() ë©”ì†Œë“œê°€ ìˆë‹¤
                
                ```java
                Supplier<String> supplier = () -> "Hello, Supplier!";
                ```
                
        4. Function<T,R>
            - í•˜ë‚˜ì˜ ì…ë ¥ì„ ë°›ì•„ ë‹¤ë¥¸ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤
            - **`R apply(T t)`** ë©”ì„œë“œê°€ ìˆìŒ
            
            ```java
            Function<Integer, String> function = (i) -> "Number: " + i;
            ```
            
        5. **UnaryOperator<T>**
            - í•˜ë‚˜ì˜ ì…ë ¥ì„ ë°›ì•„ ë™ì¼í•œ íƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤
            - **`T apply(T t)`** ë©”ì„œë“œê°€ ìˆìŒ
            
            ```java
            UnaryOperator<Integer> square = (i) -> i * i;
            ```
            

### OAuth beginner

[https://www.youtube.com/watch?v=3pZ3Nh8tgTE](https://www.youtube.com/watch?v=3pZ3Nh8tgTE)

- **Resource Owner (photo printing service)**
- **Client (user)**
- **Resource Server (google drive)**
    - has burden or security
    - **Authorization Server (of google)**
    - usually coupled

[https://www.youtube.com/watch?v=CWiwpvpCrro](https://www.youtube.com/watch?v=CWiwpvpCrro)

- OAuth is meant for authorization for API, not for authentication the user
- but if the resource server is very popular like google or facebook, client can rely on the resource server to authenticate the user
- spring security app gets the userâ€™s profile information into security context to simulate the login rather than actually logging in
- @EnableAuth2Sso : user authentication
- @EnableAuth2Client : API authorization

# ğŸ˜œÂ Todayâ€™s Small Happiness

- ê¸°ëŠ¥ ëª…ì„¸ì„œ ì‘ì„±í•´ë´¤ë‹¤ ì‹ ê¸°ì‹ ê¸°
- ë‹¤ë“¤ ì‚¬ëŒë“¤ë„ ì¢‹ê³  ê°™ì´ í”„ë¡œì íŠ¸í•˜ê¸° ì¢‹ì€ ì‚¬ëŒë“¤ì¸ë“¯! ì—­ì‹œ ì¸ë³µê°€ì´~

# ğŸ§Â Letâ€™s Think About It

- ìœ„í´ë¦¬ ë‹¨ìœ„ë¡œ ëª©í‘œëŸ‰ì„ ì •í•´ì„œ ê¾¸ì¤€íˆ ì±™ê²¨ë³´ì

# ğŸ™€Â Got Stuck..

-