# TIL (Today I Learned)

# 1ì›” 7ì¼ ì¼ìš”ì¼

# ğŸ˜ƒÂ What I Learned

## Spring Data JPA

- **Auditing**
- **Spring Data JPA ë‚´ë¶€ êµ¬í˜„ì²´ ë¶„ì„**
    - save methodì˜ persist / merge
        - isNewê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€, ì´ì— ë”°ë¥¸ ì„±ëŠ¥ ì €í•˜ê°€ ìƒê¸°ì§€ ì•Šë„ë¡ ì–´ë–»ê²Œ í•˜ëŠ”ì§€
- **ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬**
    - Projections

## í”„ë¡œì íŠ¸

- **ì£¼ë§ê°„ ì•„ì´ë””ì–´ + í”¼ë“œë°±**

## Effective Java

- 33. íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆë¥¼ ê³ ë ¤í•˜ë¼

## Reactor (ë°±ê¸°ì„  ìœ íŠœë¸Œ)

### StepVerifier

- Reactorì˜ ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¡œ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‰½ê²Œ ì§„í–‰í•´ì£¼ëŠ” ë„êµ¬
- StepVerifier.create(Supplier)
- expectNext()
- expectNextCount()
- assertNext()
- expectSubScription()
- thenAwait()
- verifyComplete()

### Transform

- mono â†’ map (sync)
    - publisherë¥¼ ë¦¬í„´
- flux â†’ **flatMap (async)**
    - **flatMap ìì²´ê°€ publisher**
    - ìˆœì„œë³´ì¥ X
    - Flux<User>ì— mapì„ ì“°ë©´ Flux<Publisher<User>>
    - Flux<User>ì— flatMapì„ ì“°ë©´ Flux<User>

### FlatMap ë³´ì¶©

- flatMap & concatMap & flatMapSequential
- A ~ Iê¹Œì§€ ìˆœì°¨ì ìœ¼ë¡œ ê°€ì ¸ì˜´ (ë¹„ë™ê¸°ì ì´ì§€ ì•ŠìŒ..!)

```java
@SpringBootTest
class TestApplicationTests {

	@Test
	void contextLoads() {
		Flux.just("a", "b", "c", "d", "e", "f", "g", "h", "i")
				.window(3)
				.flatMap(l -> l.map(this::toUpperCase))
				.doOnNext(System.out::println)
				.blockLast();
	}

	private List<String> toUpperCase(String s) {
		try {
			Thread.sleep(1000);
		} catch (InterruptedException e){
			e.printStackTrace();
		}
		return List.of(s.toUpperCase(), Thread.currentThread().getName());
	}

}
```

- subscribeOnì— ë³‘ë ¬ì ìœ¼ë¡œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤
    - ê·¸ëŸ¬ë‚˜ ì´ ë°©ì‹ì€ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•ŠìŒ (g, d, a, h, e, b, i, f, c, ìˆœì„œì„)

```java
@Test
	void contextLoads() {
		Flux.just("a", "b", "c", "d", "e", "f", "g", "h", "i")
				.window(3)
				.flatMap(l -> l.map(this::toUpperCase).subscribeOn(Schedulers.parallel()))
				.doOnNext(System.out::println)
				.blockLast();
}
```

- ìˆœì„œë¥¼ ë³´ì¥í•˜ëŠ” concatMapì„ ì‚¬ìš©í•˜ë©´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•ŠëŠ”ë‹¤
    - subscribeOn(Schedulers.parallel()) í•œ ì˜ë¯¸ê°€ ì—†ì–´ì§

```java
@Test
	void contextLoads() {
		Flux.just("a", "b", "c", "d", "e", "f", "g", "h", "i")
				.window(3)
				.concatMap(l -> l.map(this::toUpperCase).subscribeOn(Schedulers.parallel()))
				.doOnNext(System.out::println)
				.blockLast();
}
```

- **ë”°ë¼ì„œ flatMapSequentialì„ ì‚¬ìš©í•´ì•¼ ìˆœì„œë³´ì¥ë„ ë˜ê³  ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ëœë‹¤**
    - ì‘ì—… ë°©ì‹ì€ ë³µì¡í•˜ë‚˜ ê²°ë¡ ì ìœ¼ë¡œëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ë©´ì„œ ìˆœì„œê°€ ë³´ì¥ë˜ë„ë¡ ë§ˆì§€ë§‰ì— subscribeë¥¼ ì•ˆí•˜ê³  ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤ê°€ í•œë²ˆì— í•˜ëŠ” ë°©ë²•ì¸ ê²ƒ ê°™ìŒ

```java
@Test
	void contextLoads() {
		Flux.just("a", "b", "c", "d", "e", "f", "g", "h", "i")
				.window(3)
				.flatMapSequential(l -> l.map(this::toUpperCase).subscribeOn(Schedulers.parallel()))
				.doOnNext(System.out::println)
				.blockLast();
}
```

- ê¸°íƒ€
    - window(x) : x ê°œë§Œí¼ ì˜ë¼ì„œ Flux â‡’ Flux<Flux<String>>

- Merge
- BackPressure
    
    [https://www.notion.so/Java-Reactor-Merge-Request-BackPressure-5d798e46d4f04cad9141b864f77c64b1?pvs=4](https://www.notion.so/Java-Reactor-Merge-Request-BackPressure-5d798e46d4f04cad9141b864f77c64b1?pvs=21)
    

# ğŸ˜œÂ Todayâ€™s Small Happiness

- Spring Data JPA ì™„ê°•. ê·¼ë° ì§ì ‘ ì‚¬ìš©í•˜ë©´ì„œ í™œìš©í•´ë´ì•¼ ìµíë“¯..!

# ğŸ§Â Letâ€™s Think About It

- ì•Œê³ ë¦¬ì¦˜ì„ ì–´ë–»ê²Œ ê°•ì œí•  ìˆ˜ ìˆì„ì§€.. ê³ ë¯¼í•´ë´ì•¼ê² ë‹¤

# ğŸ™€Â Got Stuck..

-