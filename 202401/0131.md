# TIL (Today I Learned)

# 1ì›” 31ì¼ ìˆ˜ìš”ì¼

# ğŸ˜ƒÂ What I Learned

## í”„ë¡œì íŠ¸ 18ì¼ì°¨

### ì§„í–‰ ë‚´ìš©

**ê¹ƒ dev ë¡œì»¬ì—ì„œ pullí•˜ê³  ë¨¸ì§€í•´ì„œ conflict í•´ê²°í•˜ê³  ë¨¸ì§€í•˜ì**

### ì˜¤ëŠ˜ í•œ ë‚´ìš©

- [x]  ëª½ê³ ë””ë¹„ ì—°ë™
- [x]  ë©”íƒ€ë°ì´í„° í¬ë§· ìˆ˜ì • ë° ì €ì¥í•˜ê¸°
- [x]  ë§ˆì´í˜ì´ì§€ ì •ë³´ ë¡œì§ êµ¬í˜„
    - [x]  ì¼, ì£¼, ì›”ë³„ í‰ê·  ê³µë¶€ ì‹œê°„
        - [ ]  ì›”ì€ ì´ ê³µë¶€ì‹œê°„?? í‰ê· ??
    - [x]  ê´€ì‹¬ í‚¤ì›Œë“œ ê°€ì¤‘ì¹˜ ì£¼ì–´ì„œ ì œê³µ
    - [x]  ì£¼ìš” ê³µë¶€ ì‹œê°„ëŒ€
    - [ ]  ìœ„ ë¡œì§ ì„±ëŠ¥ ê°œì„ ? or ë©”ì†Œë“œ ë‹¨ì¼ ì›ì¹™? ê³ ë¯¼
- [ ]  ë§ˆì´í˜ì´ì§€ ì¡°ì¸ ì¿¼ë¦¬
    - [x]  til ì—°ë™
    - [ ]  íŒ”ë¡œì‰ íŒ”ë¡œì›Œ ìˆ˜

### ë‚´ì¼ í•  ë‚´ìš©

- [ ]  redis ë°ì´í„° êµ¬ì¡° ê³ ë¯¼
- [ ]  transform & groupbyë¥¼ ì‚¬ìš©í•œ ì¡°ì¸ ì¿¼ë¦¬ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ì ìš©í•  ë§Œí•œì§€ ê²€í† 
- [ ]  ë°©ê²€ìƒ‰ ì¡°ê±´ ìˆ˜ì •
- [ ]  ì¹´í”„ì¹´ ì„¸íŒ… ì‹œë„
- [ ]  [Map ì°¸ì¡° ì‚­ì œ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜) (map.clear() or weakhashmapì„ ì‚¬ìš©)](https://bepoz-study-diary.tistory.com/340) â†’ í•„ìš”í•œê°€? í•œë²ˆ ë” í™•ì¸

## ë°°ìš´ ë‚´ìš©

### ëª½ê³ ë””ë¹„ QueryDsl ì„¤ì¹˜

[https://velog.io/@404-nut-pound/Spring-Boot-3-JPAMongoDB-Querydsl-ì„¤ì •](https://velog.io/@404-nut-pound/Spring-Boot-3-JPAMongoDB-Querydsl-%EC%84%A4%EC%A0%95)

@EnableJpaRepositoriesì™€ @EnableMongoRepositoriesê°€ ë‘˜ ë‹¤ CRUDRepositoryë¥¼ íƒìƒ‰í•˜ì—¬ ì¶©ëŒì´ ì¼ì–´ë‚œë‹¤. ë•Œë¬¸ì— ê²€ìƒ‰ì„ ì‹œì‘í•˜ëŠ” basePackage ìœ„ì¹˜ë¥¼ êµ¬ë¶„í•˜ì—¬ì•¼ í•œë‹¤.

ë‚˜ëŠ” mongoDbë¥¼ ì‚¬ìš©í•˜ëŠ” metadataë¥¼ app íŒ¨í‚¤ì§€ì—ì„œ ëºë‹¤. JPAë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ê¸° ë•Œë¬¸. ì¶”í›„ ì±„íŒ…ë„ í•©ì¹  ë•Œ ì£¼ì˜í•´ì•¼ í• ë“¯

```java
@SpringBootApplication
@EnableJpaAuditing
@EnableJpaRepositories(basePackages = "com.a506.comeet.app")
@EnableMongoRepositories(basePackages = "com.a506.comeet.metadata")
public class ComeetApplication {
	public static void main(String[] args) {
		SpringApplication.run(ComeetApplication.class, args);
	}
}
```

### @Document ì‚¬ìš©

```java
@Getter
@NoArgsConstructor(access = PROTECTED)
@SQLRestriction("is_deleted = 0")
@Document(collection = "metadata")
public class Metadata extends BaseEntityWithSoftDelete {

    @Id
    private String id;
    private String memberId;
    private Long roomId;
    private LocalDateTime enterTime;
    private LocalDateTime leaveTime;
    private String keywords;

    @Builder
    public Metadata(String memberId, Long roomId, LocalDateTime enterTime, LocalDateTime leaveTime, String keywords) {
        this.memberId = memberId;
        this.roomId = roomId;
        this.enterTime = enterTime;
        this.leaveTime = leaveTime;
        this.keywords = keywords;
    }
}
```

### QClass ì§ì ‘ ìƒì„±

```java
// MongoDbì˜ QdataëŠ” ì§ì ‘ ë§Œë“¤ì–´ì¤˜ì•¼ í•œë‹¤
public class QMetadata extends EntityPathBase<Metadata> {
    private static final long serialVersionUID = 1L;

    public static final QMetadata metadata = new QMetadata("metadata");

    public final NumberPath<Long> id = createNumber("id", Long.class);
    public final StringPath memberId = createString("memberId");
    public final NumberPath<Long> roomId = createNumber("roomId", Long.class);
    public final DateTimePath<LocalDateTime> enterTime = createDateTime("enterTime", LocalDateTime.class);
    public final DateTimePath<LocalDateTime> leaveTime = createDateTime("leaveTime", LocalDateTime.class);
    public final StringPath keywords = createString("keywords");

    public QMetadata(String variable) {
        super(Metadata.class, PathMetadataFactory.forVariable(variable));
    }

    public QMetadata(Path<? extends Metadata> path) {
        super(path.getType(), path.getMetadata());
    }

    public QMetadata(PathMetadata metadata) {
        super(Metadata.class, metadata);
    }
}
```

### MongoRepository ì‚¬ìš©

- Predicateë¥¼ ì§ì ‘ ìƒì„±í•˜ì—¬ findAll() ì•ˆì— ë„£ì–´ì£¼ë©´ whereë¬¸ ì¡°ê±´ì— ì‚¬ìš©ëœë‹¤.

```java
public interface MetadataRepository extends MongoRepository<Metadata, String>, QuerydslPredicateExecutor<Metadata> {

}
```

```java
List<Metadata> metadatas = 
		(List<Metadata>) metadataRepository
		.findAll(metadata.memberId.eq(memberId)
		.and(metadata.leaveTime.gt(LocalDateTime.now().minusMonths(1).with(LocalDateTime.MIN))));
```

## **ë‹¤ëŒ€ë‹¤ ì¡°ì¸ì¿¼ë¦¬**

- transform & groupBy ì‚¬ìš©!
- ê²°êµ­ joinìœ¼ë¡œ ë°ì´í„°ê°€ ë»¥íŠ€ê¸° ë˜ì§€ë§Œ íŠ¹ì • í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ groupbyí•˜ì—¬ ë¦¬í„´ ê°’ì„ ì§€ì •í•´ì£¼ë©´ ëœë‹¤.
- GPTê°€ ì„¸ìƒ í•´ê²° ëª»í–ˆë˜ ë‚´ìš© ã… ã… 
- list, groupby ì„í¬íŠ¸ ì˜ í•´ì•¼í•¨

[https://hello-backend.tistory.com/250](https://hello-backend.tistory.com/250)

```
import static com.querydsl.core.group.GroupBy.groupBy;
import static com.querydsl.core.group.GroupBy.list;
```

```java
@Override
    public MemberDetailResponseDto getMemberDetail(String memberId) {
        LocalDate from = LocalDate.now().with(TemporalAdjusters.firstDayOfMonth());
        LocalDate to = LocalDate.now().with(TemporalAdjusters.lastDayOfMonth());
        MemberDetailResponseDto res = jpaQueryFactory.selectFrom(member)
                .leftJoin(member.tils, til)
                .where(member.memberId.eq(memberId).and(til.date.between(from, to))) // ì´ë²ˆë‹¬ ê²ƒë§Œ ê°€ì ¸ì˜´
                .distinct()
                .transform(
                        groupBy(member.memberId).list(
                                        (Projections.constructor(
                                                MemberDetailResponseDto.class,
                                                member.memberId,
                                                member.name,
                                                member.nickname,
                                                member.link,
                                                member.profileImage,
                                                member.email,
                                                member.description,
                                                member.feature,
                                                list(Projections.constructor(
                                                        TilSimpleResponseDto.class,
                                                        til.id,
                                                        til.date
                                                )))
                        )
                )).stream().findFirst().orElse(null);
        return res;
    }
```

**Caused by: java.lang.NoSuchMethodError: 'java.lang.Object org.hibernate.ScrollableResults.get(int)â€™ ì—ëŸ¬**

[https://velog.io/@dktlsk6/QueryDSL-transform-ì—ëŸ¬](https://velog.io/@dktlsk6/QueryDSL-transform-%EC%97%90%EB%9F%AC)

**spring boot 3.x ë²„ì „ë¶€í„° transformì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ê³ í•œë‹¤. ë•Œë¬¸ì— DEFAULT ëª¨ë“œë¡œ ì§€ì •í•´ì¤˜ì•¼í•œë‹¤.**

```java
@Configuration
public class QuerydslConfig {
    @PersistenceContext
    private EntityManager entityManager;

    @Bean
    public JPAQueryFactory jpaQueryFactory() {
        return new JPAQueryFactory(JPQLTemplates.DEFAULT, entityManager);
    }
}
```

## Effective Java

[45. ìŠ¤íŠ¸ë¦¼ì€ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•˜ë¼](https://www.notion.so/45-3221e963437e4617b13a6b3b8e5cdf1b?pvs=21)

## ê³µë¶€í•œ ë‚´ìš©

### ì¹´í”„ì¹´ ê³µë¶€

[https://rudaks.tistory.com/entry/spring-kafkaë¥¼-ì‚¬ìš©í• -ë•Œì˜-íŠ¸ëœì­ì…˜-ì²˜ë¦¬](https://rudaks.tistory.com/entry/spring-kafka%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C%EC%9D%98-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%B2%98%EB%A6%AC)

[https://chat.openai.com/share/2d3036b7-ed30-4636-bb25-21c7798ff9ad](https://chat.openai.com/share/2d3036b7-ed30-4636-bb25-21c7798ff9ad)

CS ì¸í„°ë·° 

[https://github.com/ksundong/backend-interview-question](https://github.com/ksundong/backend-interview-question)

# ğŸ˜œÂ Todayâ€™s Small Happiness

# ğŸ§Â Letâ€™s Think About It

# ğŸ™€Â Got Stuck..