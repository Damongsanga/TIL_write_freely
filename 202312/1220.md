# TIL (Today I Learned)

# 12ì›” 20ì¼ ìˆ˜ìš”ì¼

pray for ë¶€ë¹„

# ğŸ˜ƒÂ What I Learned

# í”„ë¡œì íŠ¸

### í˜„ì¬ ì§„í–‰ì¤‘ì¸ ë‚´ìš©

1. WebFlux ì´ìš©í•œ ë¹„ë™ê¸° ì „í™˜ ì™„ë£Œ (test ê²°ê³¼ 25ì´ˆ â†’ 15ì´ˆ ê°€ëŸ‰ìœ¼ë¡œ ê°ì†Œ, ìƒ‰ ì¶”ì¶œì„ ì œì™¸í•˜ê¸´ í–ˆìŒ, ì‹¤ì§ˆì ìœ¼ë¡œëŠ” 5ì´ˆì •ë„ ì¤„ì—ˆì„ë“¯)
2. S3 íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ
3. jpa & MySql ì—°ë™ ì™„ë£Œ, íŒŒì¼ url ê°€ì ¸ì˜¤ê¸° (ì´ê±´ DBì—ì„œ)

### ë‚´ì¼ í•  ë‚´ìš©

1. ì „ì²´ í…ŒìŠ¤íŠ¸ (ì´ë¯¸ì§€ ë„£ìœ¼ë©´ ì €ì¥ê¹Œì§€ ë˜ëŠ”ì§€)

# Effective Java

### 14. Comparableì„ êµ¬í˜„í• ì§€ ê³ ë¯¼í•˜ë¼

## Jar vs War

- Viewë¥¼ JSP? : War
- ì™¸ì¥ Was : War
- ì´ì™¸ëŠ” Jar
    - ìŠ¤í”„ë§ ì§„ì˜ì—ì„œëŠ” Jarë¥¼ ë°€ê³ ìˆìŒ
    - Jar ì¨ë„ JSP, ì™¸ì¥ Was ì‚¬ìš©í•  ìˆ˜ëŠ” ìˆìŒ (?)
    - ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ë˜ë„ë¡ JSPë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ìœ ë„í•¨

- **ë‚˜ëŠ” ê°œë°œìì„ìœ¼ë¡œ ì†ŒìŠ¤íŒŒì¼ì„ gitì— ì˜¬ë¦¬ê¸°ë§Œ í•˜ë©´ ëœë‹¤**
    - Jar, War ìƒê´€ì—†ìŒ (ë¹Œë“œë¥¼ í•˜ëŠ” ê²ƒì´ ì•„ë‹˜ìœ¼ë¡œ)
- **ë‹¨ë… í”„ë¡œì íŠ¸ë¡œ ë‚´ê°€ ë°°í¬ë¥¼ í•´ì•¼í•œë‹¤**
    - Jar, War ê³ ë ¤í•´ì•¼ í•¨

# ğŸ˜œÂ Todayâ€™s Small Happiness

- ë¹„ë™ê¸° ì½”ë“œ ì „í™˜ ì™„ë£Œ!
    - **Fluxë¥¼ ë¦¬í„´í•˜ê²Œ í•˜ì—¬ í™œìš©í•˜ëŠ” ê³³(ì»¨íŠ¸ë¡¤ëŸ¬)ì—ì„œëŠ” ì´ë¥¼ subscribeí•˜ì—¬ ì‚¬ìš©**
    - ì‚¬ìš© ë©”ì†Œë“œ
        - fromIterable
        - sort
        - take
        - map

```java
// ë™ê¸° ì½”ë“œ (ë¹„ë™ê¸° ì „í™˜ ì „)

@Autowired
private CloudVisionTemplate cloudVisionTemplate;

@Override
public List<PromptDTO> getKeywords(List<ImageRequest> imageRequests) {

    List<PromptDTO> promptList = new ArrayList<>();

    for (ImageRequest imageRequest : imageRequests) {
        Resource imageResource = resourceLoader.getResource(imageRequest.getUrl());
        AnnotateImageResponse res = this.cloudVisionTemplate.analyzeImage(imageResource,
                Feature.Type.LABEL_DETECTION);

        for (EntityAnnotation e : res.getLabelAnnotationsList().stream().
                sorted(((o1, o2) -> (int) ((o2.getScore() - o1.getScore()) * 10000))).
                limit(MAX_KEYWORD_COUNT).toList()) {
            promptList.add(new PromptDTO(e.getDescription(), e.getScore(), PromptDTOEnum.KEYWORD.getType()));
        }

    }

    return promptList;
}
```

```java
// ë¹„ë™ê¸° ì „í™˜ ì½”ë“œ
@Autowired
private CloudVisionTemplate cloudVisionTemplate;

@Override
public Flux<PromptDTO> getKeywords(List<ImageRequest> imageRequests) {
    return Flux.fromIterable(imageRequests)
            .flatMap(imageRequest -> {
                Resource imageResource = resourceLoader.getResource(imageRequest.getUrl());

                // cloudVisionTemplateë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ê¸°ì ìœ¼ë¡œ ì´ë¯¸ì§€ ë¶„ì„ ìˆ˜í–‰
                AnnotateImageResponse res = cloudVisionTemplate.analyzeImage(imageResource,
                        Feature.Type.LABEL_DETECTION);

                return Flux.fromIterable(res.getLabelAnnotationsList())
                        .sort((o1, o2) -> (int) ((o2.getScore() - o1.getScore()) * 10000))
                        .take(MAX_KEYWORD_COUNT)
                        .map(e -> new PromptDTO(e.getDescription(), e.getScore(), PromptDTOEnum.KEYWORD.getType()));
            });
}
```

```java
//MainController í™œìš©

Map<String, List<PromptDTO>> promptDTOMap = new HashMap<>();
List<PromptDTO> keywords = new ArrayList<>();
//Fluxë¥¼ subscribeí•˜ì—¬ ì‚¬ìš©
cloudVisionService.getKeywords(imageRequests).subscribe((promptDTO -> keywords.add(promptDTO)));
promptDTOMap.put("keywords", keywords);
```

# ğŸ§Â Letâ€™s Think About It

# ğŸ™€Â Got Stuck..