# TIL (Today I Learned)

# 12월 9일 토요일

# 😃 What I Learned

## 김영한 JPA 9강 값타입

- 기본값타입 : primitive

- 임베디드타입 : 기본값타입을 모은 복합값타입
    - **임베디드 타입은 엔티티의 값일 뿐이므로 임베디드 타입을 사용해도 매핑하는 테이블은 변화가 없다**
    
    **@Embeddable: 값 타입을 정의하는 곳에 표시**
    
    **@Embedded : 값 타입을 사용하는 곳에 표시**
    
    **기본 생성자 필수**
    

- 컬렉션타입
    
    **@ElementCollection, @CollectionTable 사용**
    
    **데이터베이스는 컬렉션을 같은 테이블에 저장할 수 없다. (일대다개념)**
    
    **컬렉션을 저장하기 위한 별도의 테이블이 필요함**
    
    참고: 값 타입 컬렉션은 영속성 전에(Cascade) + 고아 객체 제거 기능을 필수로 가진다고 볼 수 있다.
    
    - 제약사항
        - **값 타입은 엔티티와 다르게 식별자 개념이 없다. ⇒ 값은 변경하면 추적이 어렵다**
        - **따라서 값 타입 컬렉션에 변경 사항이 발생하면, 주인 엔티티와 연관된모든 데이터를 삭제하고, 값 타입 컬렉션에 있는 현재 값을 모두 다시 저장한다.**
            
            **값 타입 컬렉션을 매핑하는 테이블은 모든 컬럼을 묶어서 기본키를 구성해야 함: null 입력X, 중복 저장X**
            
            ### **⇒ 실무에서는 상황에 따라 값 타입 컬렉션 대신에 일대다 관계를 고려**
            
            일대다 관계를 위한 엔티티를 만들고, 여기에서 값 타입을 사용
            
            영속성 전이(Cascade) + 고아 객체 제거를 사용해서 값 타입 컬렉션 처럼 사용
            
            EX) AddressEntity
            
    - 언제 사용?
        - **변경이 가능하거나 추적이 필요하면 무조건 엔티티**
        - **매우 단순하고 수정될 일도 없고 추척도 필요 없으면 값 타입을 사용**
    
- 엔티티

- 값타입은 모두 불변 객체로 만들어야 한다
    
    가장 단순한 방법으로는 **생성자로만 값을 설정하고 수정자(Setter)를 만들지 않으면 됨**
    
    **값 타입 비교를 위해 equals() 메소드를 적절하게 재정의(주로 모든 필드 사용)**
    

[https://www.notion.so/9-808d86f4bde5476b8ee5070a38236730?pvs=4](https://www.notion.so/9-808d86f4bde5476b8ee5070a38236730?pvs=21)

# 😜 Today’s Small Happiness

- 

# 🧐 Let’s Think About It

- 

# 🙀 Got Stuck..