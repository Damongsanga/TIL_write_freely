# TIL (Today I Learned)

# 7μ›” 15μΌ μ›”μ”μΌ

# πƒΒ What I Learned

## β¨μ¤λ μ§„ν–‰ν• λ‚΄μ©

- [x]  SQL λ¬Έμ  λ° μ•κ³ λ¦¬μ¦ λ¬Έμ  1κ° ν’€κΈ° β†’ μ•κ³ λ¦¬μ¦ λ»ν’. λ‚΄μΌ λ§μ € ν’€μ.. (2μ‹κ°„)
- [x]  λ‹¤λ¥Έ μ‚¬λ μ½”λ“ κ³µλ¶€ν•κΈ° (2μ‹κ°„)
    - [x]  [https://translucent-guan-106.notion.site/soo_step1-2-125b7b28e4364affbb7cd5f56a7e1990?pvs=4](https://www.notion.so/soo_step1-2-125b7b28e4364affbb7cd5f56a7e1990?pvs=21)
    - [x]  [https://translucent-guan-106.notion.site/soo_step-2-Comment-1-e5889f156b6c4464b2d631f8d927d7c7?pvs=4](https://www.notion.so/soo_step-2-Comment-1-e5889f156b6c4464b2d631f8d927d7c7?pvs=21)
- [x]  ν—¬μ¤μ¥ κ°€κΈ° (1μ‹κ°„)

- [x]  μ±„μ μ„λ²„ (4μ‹κ°„)
    - [x]  μ±„μ μ„λ²„ Request, Response λ“± record μ μ©
    - [x]  μ±„μ  μ„λ²„ **μ…λ ¥ λ“¤μ–΄μ¨ ν† ν°λ“¤μ΄ uuidμΈμ§€ κ²€μ‚¬ (λ‘λ‹¤ λ΄μ¤μ•Όν•¨)**
        - [x]  TokenCreatorμ— validation λ΅μ§ μ¶”κ°€ν•λ©΄μ„ TokenMangerλ΅ λ³€κ²½
    - [x]  λ©”μΈ μ„λ²„ λ½ κ±Έμ–΄μ•Ό ν•λ” κµ¬λ¬Έλ“¤ μμ •
    - [x]  λ©”μΈ μ„λ²„ μ¶”κ°€ λ¦¬ν©ν† λ§
        - [x]  SELECT ν•κ³  isNullλ΅ λ³΄μ§€ λ§κ³  exist μΏΌλ¦¬ μ§μ ‘ κµ¬ν„
            
            count(*) > 1 μΌλ΅ ν•λ”κ²ƒμ€ μ„±λ¥μ΄ μΆ‹μ§€ μ•μ. 
            
            **@Queryλ΅ κµ¬ν„ν•κΈ° λ³΄λ‹¤λ” querydslλ΅ κµ¬ν„ν•¨**
            
            ```java
            @Override
                public boolean existsByIdAndHasGithubRepository(Long id) {
                    Integer fetchOne = jpaQueryFactory.selectOne()
                            .from(member)
                            .where(member.id.eq(id).and(member.githubUniqueId.isNotNull()))
                            .fetchFirst(); // == limit(1).fetchOne()
            
                    return fetchOne != null;
                }
            ```
            
        - [x]  μ°½μ§„μ΄κ°€ μ§  μ›Ήμ†μΌ“ μ»¨νΈλ΅¤λ¬μ— λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ „λ¶€μ€μ (μ‚¬μ‹¤μƒ μ„λΉ„μ¤ κ³„μΈµ μ—­ν• κΉμ§€ ν•κ³  μμ—μ)
        - [x]  RoomWebsocketController, SolveWebsocketController λΉ„μ¦λ‹μ¤ λ΅μ§ μ„λΉ„μ¤ κ³„μΈµμΌλ΅ λ¨λ‘ λ¦¬ν©ν† λ§
        - [x]  Request, Response μμ • λ° μ±…μ„ μµλ€ν• λ‚λ„λ ¤κ³  λ…Έλ ¥
        - [x]  μ „μ²΄ μ»¨λ²¤μ…μ€.. λ‹¤ λ§μ¶”λ” κ²ƒμ€ λ¬΄λ¦¬μΌλ“―..

- [ ]  [**Select μΏΌλ¦¬λ” Sλ½μ΄ μ•„λ‹λ‹¤. (Xλ½κ³Ό Sλ½μ μ°¨μ΄)](https://velog.io/@soongjamm/Select-%EC%BF%BC%EB%A6%AC%EB%8A%94-S%EB%9D%BD%EC%9D%B4-%EC%95%84%EB%8B%88%EB%8B%A4.-X%EB%9D%BD%EA%B3%BC-S%EB%9D%BD%EC%9D%98-%EC%B0%A8%EC%9D%B4) β‡’ λ‚΄μ© κ°„λ‹¨ν•κ²λ§ μ •λ¦¬**
- [ ]  μΉ΄ν”„μΉ΄ μ½”λ“ λ° λ„μ»¤ μ„¤μΉλ²• κ³ λ―Ό

## β¨κ³µλ¶€ν• λ‚΄μ©

[**Select μΏΌλ¦¬λ” Sλ½μ΄ μ•„λ‹λ‹¤. (Xλ½κ³Ό Sλ½μ μ°¨μ΄)**](https://velog.io/@soongjamm/Select-%EC%BF%BC%EB%A6%AC%EB%8A%94-S%EB%9D%BD%EC%9D%B4-%EC%95%84%EB%8B%88%EB%8B%A4.-X%EB%9D%BD%EA%B3%BC-S%EB%9D%BD%EC%9D%98-%EC%B0%A8%EC%9D%B4)

### `@Modifying`  μ€ μ™ μ‚¬μ©ν•΄μ•Όν•λ”κ°€?

- clearAutomatically
- flushAutomatically

JPQLμ—μ„

`@Modifying` μ–΄λ…Έν…μ΄μ…μ€ μ£Όλ΅ λ°μ΄ν„°λ¥Ό μμ •ν•κ±°λ‚ μ‚­μ ν•λ” JPQL μΏΌλ¦¬ λ©”μ„λ“μ—μ„ μ‚¬μ©λ©λ‹λ‹¤. μ΄ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” μ΄μ λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

1. **JPQLμ Side Effect Operations μ²λ¦¬**: JPQLμ€ κΈ°λ³Έμ μΌλ΅ μΏΌλ¦¬λ¥Ό μ‹¤ν–‰ν•  λ• λ°μ΄ν„°λ² μ΄μ¤μ—μ„ λ°μ΄ν„°λ¥Ό μμ •ν•κ±°λ‚ μ‚­μ ν•λ” λ“±μ "λ¶€μ‘μ©" μ‘μ—…μ„ μ²λ¦¬ν•μ§€ μ•μµλ‹λ‹¤. μ΄λ” JPQLμ΄ λ°μ΄ν„°μ λ³€κ²½μ„ λ©μ μΌλ΅ ν•λ” κ²½μ°μ—λ” `@Modifying` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ λ…μ‹μ μΌλ΅ μ΄λ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
2. **μμ†μ„± μ»¨ν…μ¤νΈμ λ™κΈ°ν™”**: JPAμ—μ„λ” μμ†μ„± μ»¨ν…μ¤νΈλΌλ” λ©”λ¨λ¦¬ λ‚΄ λ°μ΄ν„° μ €μ¥μ†λ¥Ό μ‚¬μ©ν•μ—¬ μ—”ν‹°ν‹°λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤. `@Modifying` μ–΄λ…Έν…μ΄μ…μ΄ μλ” λ©”μ„λ“λ” λ°μ΄ν„°λ² μ΄μ¤ μΏΌλ¦¬λ¥Ό μ‹¤ν–‰ν•κ³  λ‚λ©΄ μμ†μ„± μ»¨ν…μ¤νΈλ¥Ό μλ™μΌλ΅ λ™κΈ°ν™”ν•μ§€ μ•μµλ‹λ‹¤. λ”°λΌμ„ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ λ³€κ²½λ λ°μ΄ν„°λ¥Ό μμ†μ„± μ»¨ν…μ¤νΈμ— λ°μν•κΈ° μ„ν•΄μ„  λ…μ‹μ μΌλ΅ `EntityManager`μ `flush()` λ©”μ„λ“λ¥Ό νΈμ¶ν•΄μ•Ό ν•©λ‹λ‹¤.
3. **νΈλμ­μ… κ΄€λ¦¬**: `@Modifying` μ–΄λ…Έν…μ΄μ…μ΄ λ¶™μ€ λ©”μ„λ“λ” μ£Όλ΅ λ°μ΄ν„° μμ • μ‘μ—…μ„ ν¬ν•¨ν•λ―€λ΅, νΈλμ­μ… κ΄€λ¦¬κ°€ μ¤‘μ”ν•©λ‹λ‹¤. μ΄ λ©”μ„λ“κ°€ μ‹¤ν–‰λ  λ• ν•„μ”ν• λ°μ΄ν„° λ³€κ²½μ΄ νΈλμ­μ… λ‚΄μ—μ„ μ›μμ μΌλ΅ μ²λ¦¬λμ–΄μ•Ό ν•λ©°, νΈλμ­μ… λ΅¤λ°±μ΄ ν•„μ”ν• κ²½μ°μ—λ” λ°μ΄ν„°λ² μ΄μ¤ μƒνƒλ¥Ό μ΄μ „ μƒνƒλ΅ λ³µκµ¬ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤.

### μμ‹

```java
@Modifying
@Query("UPDATE Member m SET m.nickname = :nickname WHERE m.id = :id")
void updateNickname(@Param("id") Long id, @Param("nickname") String nickname);
```

μ„μ μμ μ—μ„ `@Modifying` μ–΄λ…Έν…μ΄μ…μ΄ μ‚¬μ©λ λ©”μ„λ“λ” λ°μ΄ν„°λ² μ΄μ¤μ `Member` μ—”ν‹°ν‹°μ `nickname`μ„ μ—…λ°μ΄νΈν•©λ‹λ‹¤. μ΄ λ©”μ„λ“λ” λ°μ΄ν„° μμ • μ‘μ—…μ„ ν¬ν•¨ν•κ³  μμΌλ―€λ΅ `@Modifying` μ–΄λ…Έν…μ΄μ…μ΄ ν•„μ”ν•©λ‹λ‹¤.

λ”°λΌμ„ `@Modifying` μ–΄λ…Έν…μ΄μ…μ€ JPQL μΏΌλ¦¬ λ©”μ„λ“μ—μ„ λ°μ΄ν„° λ³€κ²½ μ‘μ—…μ„ λ…μ‹μ μΌλ΅ μ§€μ •ν•κ³ , μ΄ μ‘μ—…μ΄ λ°μ΄ν„°λ² μ΄μ¤μ— λ°μλλ„λ΅ λ„μ™€μ¤λ‹λ‹¤.

μ°Έμ΅°

[https://joojimin.tistory.com/71](https://joojimin.tistory.com/71)

## β¨λ‚΄μΌ μ§„ν–‰ν•  λ‚΄μ©

- [ ]  SQL λ§λ¬΄λ¦¬ λ° μ•κ³ λ¦¬μ¦ λ§μ € ν’€κΈ°
- [ ]  μ±„μ© κ³µκ³  ν™•μΈ
- [ ]  λ°μ΄ν„° μ¤‘μ‹¬ μ–΄ν”λ¦¬μΌ€μ΄μ… μ„¤κ³„ λ€μ—¬ν•κΈ°
    - [ ]  μΉ΄μΉ΄μ¤ **Zero-ETL**Β : [https://careers.kakao.com/jobs/P-13629?skillSet=&part=TECHNOLOGY&company=KAKAO&keyword=&employeeType=&page=1](https://careers.kakao.com/jobs/P-13629?skillSet=&part=TECHNOLOGY&company=KAKAO&keyword=&employeeType=&page=1)
- [ ]  μ±„μ  μ„λ²„
    - [ ]  **μΉ΄ν”„μΉ΄ μ„¤μΉ λ° ν…μ¤νΈν•΄λ³΄κΈ°**
- [ ]  μ¤ν„°λ”” μ¤€λΉ„
- [ ]  μ¤ν„°λ”” (3μ‹κ°„)

# πΒ Todayβ€™s Small Happiness

# π§Β Letβ€™s Think About It

# π™€Β Got Stuck..